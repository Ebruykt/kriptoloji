<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <title>Klasik Åžifrelemeler</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    *{box-sizing:border-box;}
    body{
      margin:0; padding:0;
      font-family:Segoe UI, Roboto, Arial, sans-serif;
      color:#e9ecff;
      background:
        radial-gradient(900px 500px at -10% -10%, #1e3a8a55 0%, transparent 60%),
        radial-gradient(900px 500px at 110% 0%, #7c3aed55 0%, transparent 55%),
        linear-gradient(135deg, #0b1020, #171a2b 60%, #111827);
      min-height:100vh;
      display:flex; justify-content:center; align-items:flex-start;
    }
    .container{
      width:92%; max-width:760px;
      margin:40px 0;
      background:linear-gradient(180deg,#1b2140,#121833);
      border:1px solid #2a325d;
      border-radius:16px;
      padding:24px 22px 28px;
      box-shadow:0 12px 30px rgba(0,0,0,.45);
    }
    h1{
      text-align:center; margin:4px 0 18px;
      font-weight:800; letter-spacing:.2px;
      background:linear-gradient(90deg,#7dd3fc,#a78bfa,#fb7185);
      -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    label{Display:block; font-weight:600; margin-top:12px; color:#cbd5ff;}
    select,input,textarea{
      width:100%; margin-top:6px;
      padding:12px 12px; font-size:15px; color:#e9ecff;
      background:#0f1533;
      border:1px solid #2a3472; border-radius:12px;
      outline:none; transition:.18s ease;
    }
    select:focus,input:focus,textarea:focus{
      border-color:#60a5fa; box-shadow:0 0 0 3px #60a5fa33;
      background:#0c1230;
    }
    textarea{resize:vertical;}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
    @media(max-width:640px){.row{grid-template-columns:1fr;}}

    .btn{
      width:100%; padding:12px; border:none; border-radius:12px;
      font-size:16px; font-weight:700; cursor:pointer; color:#0b1020;
      transition:transform .06s ease, filter .15s ease;
    }
    .btn:active{transform:translateY(1px)}
    .encrypt{background:linear-gradient(135deg,#38bdf8,#1d4ed8);}
    .decrypt{background:linear-gradient(135deg,#fb7185,#f59e0b);}
    .encrypt:hover,.decrypt:hover{filter:brightness(1.06);}

    pre{
      background:#0b1130; border:1px dashed #334074;
      border-radius:12px; padding:12px; min-height:68px; white-space:pre-wrap;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Klasik Åžifrelemeler</h1>

    <label for="method">Algoritma SeÃ§in</label>
    <select id="method"></select>

    <div id="params" class="row"></div>

    <label for="text">Metin</label>
    <textarea id="text" rows="5" placeholder="Åžifrelenecek veya Ã§Ã¶zÃ¼lecek metni yazÄ±n..."></textarea>

    <div class="row" style="margin-top:14px;">
      <button class="btn encrypt" onclick="callApi('encrypt')">ðŸ”’ Åžifrele</button>
      <button class="btn decrypt" onclick="callApi('decrypt')">ðŸ”“ Ã‡Ã¶z</button>
    </div>

    <h3 style="margin:18px 4px 8px;">SonuÃ§</h3>
    <pre id="out"></pre>
  </div>

<script>
const PARAMS = {
  caesar: [{key:"k",label:"KaydÄ±rma (k)",type:"number",value:3}],
  vigenere: [{key:"key",label:"Anahtar",type:"text",value:"key"}],
  substitution: [{key:"mapping",label:"26 Harf Harita",type:"text",value:"qwertyuiopasdfghjklzxcvbnm"}],
  affine: [
    {key:"a",label:"a (gcd(a,26)=1)",type:"number",value:5},
    {key:"b",label:"b",type:"number",value:8}
  ],
  // Yeni eklemeler: hill ve railfence iÃ§in parametre tanÄ±mlarÄ±
  hill: [{key:"key",label:"Anahtar (4 veya 9 harf)",type:"text",value:"GYBN"}],
  railfence: [{key:"rails",label:"Ray SayÄ±sÄ±",type:"number",value:3}]
};

async function loadAlgos(){
  const res = await fetch('/api/algorithms');
  const algos = await res.json();
  const sel = document.getElementById('method');
  sel.innerHTML = algos.map(a=>`<option>${a}</option>`).join('');
  sel.onchange = renderParams;
  renderParams();
}
function renderParams(){
  const m = document.getElementById('method').value;
  const box = document.getElementById('params');
  const defs = PARAMS[m]||[];
  box.innerHTML = defs.map(p=>`
    <div>
      <label>${p.label}</label>
      <input id="p-${p.key}" type="${p.type}" value="${p.value??''}">
    </div>`).join('');
}
async function callApi(kind){
  const method = document.getElementById('method').value;
  const text = document.getElementById('text').value;
  const defs = PARAMS[method]||[];
  const options = {};
  defs.forEach(p => options[p.key] = document.getElementById('p-'+p.key)?.value);
  const res = await fetch('/api/'+kind, {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({method, text, options})
  });
  const js = await res.json();
  document.getElementById('out').textContent = js.result || ("Hata: " + js.error);
}
loadAlgos();
</script>
</body>
</html>
